{
	"name": "dataflow1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "DS_Output_CSV",
						"type": "DatasetReference"
					},
					"name": "Relacional"
				},
				{
					"dataset": {
						"referenceName": "DS_GarageRaw",
						"type": "DatasetReference"
					},
					"name": "srcMongoGarage1"
				},
				{
					"dataset": {
						"referenceName": "DS_BsmtRaw",
						"type": "DatasetReference"
					},
					"name": "srcMongoBsmt"
				},
				{
					"dataset": {
						"referenceName": "DS_PoolRaw",
						"type": "DatasetReference"
					},
					"name": "srcMongoPool"
				},
				{
					"dataset": {
						"referenceName": "DS_MiscRaw",
						"type": "DatasetReference"
					},
					"name": "srcMongoMisc"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "SelGarage"
				},
				{
					"name": "drvGarageFixType"
				},
				{
					"name": "SelBsmt"
				},
				{
					"name": "derivedFixTypes"
				},
				{
					"name": "SelectPool"
				},
				{
					"name": "SelectMisc"
				},
				{
					"name": "derivedPoolFixTypes"
				},
				{
					"name": "FixMiscTypes"
				},
				{
					"name": "JoinRelyGarage"
				},
				{
					"name": "Joinbsmt"
				},
				{
					"name": "Joinpool"
				},
				{
					"name": "JoinMisc"
				},
				{
					"name": "select1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          PID as integer,",
				"          MSSubClass as short,",
				"          MSZoning as string,",
				"          LotFrontage as short,",
				"          LotArea as integer,",
				"          Street as string,",
				"          Alley as string,",
				"          LotShape as string,",
				"          LandContour as string,",
				"          Utilities as string,",
				"          LotConfig as string,",
				"          LandSlope as string,",
				"          Neighborhood as string,",
				"          Condition1 as string,",
				"          Condition2 as string,",
				"          BldgType as string,",
				"          HouseStyle as string,",
				"          OverallQual as short,",
				"          OverallCond as short,",
				"          YearBuilt as date,",
				"          YearRemodAdd as short,",
				"          RoofStyle as string,",
				"          RoofMatl as string,",
				"          Exterior1st as string,",
				"          Exterior2nd as string,",
				"          MasVnrType as string,",
				"          MasVnrArea as short,",
				"          ExterQual as string,",
				"          ExterCond as string,",
				"          Foundation as string,",
				"          Heating as string,",
				"          HeatingQC as string,",
				"          CentralAir as boolean,",
				"          Electrical as string,",
				"          {1stFlrSF} as short,",
				"          {2ndFlrSF} as short,",
				"          LowQualFinSF as short,",
				"          GrLivArea as short,",
				"          FullBath as short,",
				"          HalfBath as short,",
				"          Bedroom as short,",
				"          Kitchen as short,",
				"          KitchenQual as string,",
				"          TotRmsAbvGrd as short,",
				"          Functional as string,",
				"          Fireplaces as short,",
				"          FireplaceQu as string,",
				"          PavedDrive as string,",
				"          WoodDeckSF as short,",
				"          OpenPorchSF as short,",
				"          EnclosedPorch as short,",
				"          {3SsnPorch} as short,",
				"          ScreenPorch as short,",
				"          Fence as string,",
				"          MoSold as short,",
				"          YrSold as short,",
				"          SaleType as string,",
				"          SaleCondition as string,",
				"          SalePrice as integer",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false) ~> Relacional",
				"source(output(",
				"          {Garage Area} as ({$numberLong} as short),",
				"          {Garage Cars} as ({$numberLong} as short),",
				"          {Garage Cond} as string,",
				"          {Garage Finish} as string,",
				"          {Garage Qual} as string,",
				"          {Garage Type} as string,",
				"          {Garage Yr Blt} as ({$numberLong} as short),",
				"          Order as ({$numberLong} as short),",
				"          PID as ({$numberLong} as integer),",
				"          {_id} as ({$oid} as string)",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     documentForm: 'documentPerLine') ~> srcMongoGarage1",
				"source(output(",
				"          {Bsmt Cond} as string,",
				"          {Bsmt Exposure} as string,",
				"          {Bsmt Full Bath} as ({$numberLong} as short),",
				"          {Bsmt Half Bath} as ({$numberLong} as boolean),",
				"          {Bsmt Qual} as string,",
				"          {Bsmt Unf SF} as ({$numberLong} as short),",
				"          {BsmtFin SF 1} as ({$numberLong} as short),",
				"          {BsmtFin SF 2} as ({$numberLong} as short),",
				"          {BsmtFin Type 1} as string,",
				"          {BsmtFin Type 2} as string,",
				"          PID as ({$numberLong} as integer),",
				"          {Total Bsmt SF} as ({$numberLong} as short),",
				"          {_id} as ({$oid} as string)",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     documentForm: 'documentPerLine') ~> srcMongoBsmt",
				"source(output(",
				"          PID as ({$numberLong} as integer),",
				"          {Pool Area} as ({$numberLong} as short),",
				"          {Pool QC} as string,",
				"          {_id} as ({$oid} as string)",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     documentForm: 'documentPerLine') ~> srcMongoPool",
				"source(output(",
				"          {Misc Feature} as string,",
				"          {Misc Val} as ({$numberLong} as short),",
				"          PID as ({$numberLong} as integer),",
				"          {_id} as ({$oid} as string)",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     ignoreNoFilesFound: false,",
				"     documentForm: 'documentPerLine') ~> srcMongoMisc",
				"srcMongoGarage1 select(mapColumn(",
				"          {Garage Area},",
				"          {Garage Cars},",
				"          {Garage Cond},",
				"          {Garage Finish},",
				"          {Garage Qual},",
				"          {Garage Type},",
				"          {Garage Yr Blt},",
				"          PID",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelGarage",
				"SelGarage derive({PID Int} = toInteger(PID.{$numberLong}),",
				"          {Garage Area Int} = toInteger({Garage Area}.{$numberLong}),",
				"          {Garage Yr Blt Int} = toInteger({Garage Yr Blt}.{$numberLong}),",
				"          {Garage Cars Int} = toInteger({Garage Cars}.{$numberLong})) ~> drvGarageFixType",
				"srcMongoBsmt select(mapColumn(",
				"          {Bsmt Cond},",
				"          {Bsmt Exposure},",
				"          {Bsmt Full Bath},",
				"          {Bsmt Half Bath},",
				"          {Bsmt Qual},",
				"          {Bsmt Unf SF},",
				"          {BsmtFin SF 1},",
				"          {BsmtFin SF 2},",
				"          {BsmtFin Type 1},",
				"          {BsmtFin Type 2},",
				"          PID,",
				"          {Total Bsmt SF}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelBsmt",
				"SelBsmt derive({PID Int} = toInteger(PID.{$numberLong}),",
				"          {BsmtFin SF 1 Int} = toInteger({BsmtFin SF 1}.{$numberLong}),",
				"          {BsmtFin SF 2 Int} = toInteger({BsmtFin SF 2}.{$numberLong}),",
				"          {Total Bsmt SF Int} = toInteger({Total Bsmt SF}.{$numberLong}),",
				"          {Bsmt Full Bath Int} = toInteger({Bsmt Full Bath}.{$numberLong}),",
				"          {Bsmt Half Bath Int} = iif(\r",
				"    isNull({Bsmt Half Bath}.{$numberLong}),\r",
				"    0,\r",
				"    iif({Bsmt Half Bath}.{$numberLong}, 1, 0)\r",
				")) ~> derivedFixTypes",
				"srcMongoPool select(mapColumn(",
				"          PID,",
				"          {Pool Area},",
				"          {Pool QC}",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectPool",
				"srcMongoMisc select(mapColumn(",
				"          {Misc Feature},",
				"          {Misc Val},",
				"          PID",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> SelectMisc",
				"SelectPool derive({PID Int} = toInteger(PID.{$numberLong}),",
				"          {Pool Area Int} = toInteger({Pool Area}.{$numberLong})) ~> derivedPoolFixTypes",
				"SelectMisc derive({PID Int} = toInteger(PID.{$numberLong}),",
				"          {Misc Val Int} = toInteger({Misc Val}.{$numberLong})) ~> FixMiscTypes",
				"Relacional, drvGarageFixType join(Relacional@PID == {PID Int},",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinRelyGarage",
				"JoinRelyGarage, derivedFixTypes join(Relacional@PID == derivedFixTypes@{PID Int},",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> Joinbsmt",
				"Joinbsmt, derivedPoolFixTypes join(Relacional@PID == derivedPoolFixTypes@{PID Int},",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> Joinpool",
				"Joinpool, FixMiscTypes join(Relacional@PID == FixMiscTypes@{PID Int},",
				"     joinType:'left',",
				"     matchType:'exact',",
				"     ignoreSpaces: false,",
				"     broadcast: 'auto')~> JoinMisc",
				"JoinMisc select(mapColumn(",
				"          each(match(/* All input columns */ true()),",
				"               /* Input name */ $$ = $$),",
				"          PID = Relacional@PID,",
				"          MSSubClass,",
				"          MSZoning,",
				"          LotFrontage,",
				"          LotArea,",
				"          Street,",
				"          Alley,",
				"          LotShape,",
				"          LandContour,",
				"          Utilities,",
				"          LotConfig,",
				"          LandSlope,",
				"          Neighborhood,",
				"          Condition1,",
				"          Condition2,",
				"          BldgType,",
				"          HouseStyle,",
				"          OverallQual,",
				"          OverallCond,",
				"          YearBuilt,",
				"          YearRemodAdd,",
				"          RoofStyle,",
				"          RoofMatl,",
				"          Exterior1st,",
				"          Exterior2nd,",
				"          MasVnrType,",
				"          MasVnrArea,",
				"          ExterQual,",
				"          ExterCond,",
				"          Foundation,",
				"          {Bsmt Qual},",
				"          {Bsmt Cond},",
				"          {Bsmt Exposure},",
				"          {BsmtFin Type 1},",
				"          {BsmtFin SF 1} = BsmtFin SF 1,",
				"          {BsmtFin Type 2},",
				"          {BsmtFin SF 2} = BsmtFin SF 2,",
				"          {Bsmt Unf SF} = Bsmt Unf SF,",
				"          {Total Bsmt SF} = Total Bsmt SF,",
				"          Heating,",
				"          HeatingQC,",
				"          CentralAir,",
				"          Electrical,",
				"          {1stFlrSF},",
				"          {2ndFlrSF},",
				"          LowQualFinSF",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> select1"
			]
		}
	}
}